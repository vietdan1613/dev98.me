---
title: "Next.js 8 - File Based Routing"
category: Next JS
author: Daniel Nguyen
tags: ['#NextJS']
date: 2024-08-01
thumbnail: image.jpg
featured: true
---

Next.js supports **file-based routing**, meaning that the folder structure inside the `pages/` or `app/` directory **automatically defines routes**. Let's explore both **App Router (Next.js 13+)** and **Pages Router (Legacy).**

---

# **1. File-Based Routing in Next.js (App Router - `app/`)**
Introduced in Next.js 13, the **App Router** (`app/` directory) uses **React Server Components (RSC)** and a more **modern routing system**.

## **1.1 Defining Routes (Automatic Routing)**
- Every `.js`, `.jsx`, or `.tsx` file inside `app/` becomes a **route**.
- The folder structure defines **nested routes**.

```
app/
 â”œâ”€â”€ layout.js        â†’ Shared layout (wrapping all pages)
 â”œâ”€â”€ page.js          â†’ Home page ("/")
 â”œâ”€â”€ about/
 â”‚   â”œâ”€â”€ page.js      â†’ About page ("/about")
 â”‚   â”œâ”€â”€ team/
 â”‚       â”œâ”€â”€ page.js  â†’ Team page ("/about/team")
 â”œâ”€â”€ blog/
 â”‚   â”œâ”€â”€ page.js      â†’ Blog homepage ("/blog")
 â”‚   â”œâ”€â”€ [slug]/
 â”‚       â”œâ”€â”€ page.js  â†’ Dynamic route ("/blog/:slug")
```

### **Example: Home Page (`/`)**
`app/page.js`
```jsx
export default function HomePage() {
  return <h1>Welcome to Next.js</h1>;
}
```

### **Example: About Page (`/about`)**
`app/about/page.js`
```jsx
export default function AboutPage() {
  return <h1>About Us</h1>;
}
```

---

## **1.2 Dynamic Routes (`[slug]`)**
For **dynamic pages**, use square brackets `[param]` in folder names.

Example for `/blog/:slug`:
```
app/blog/
 â”œâ”€â”€ [slug]/
 â”‚   â”œâ”€â”€ page.js    â†’ "/blog/:slug"
```

`app/blog/[slug]/page.js`
```jsx
export default function BlogPost({ params }) {
  return <h1>Blog Post: {params.slug}</h1>;
}
```
ğŸ“Œ URL `/blog/nextjs-routing` â†’ Shows `Blog Post: nextjs-routing`

---

## **1.3 Catch-All Routes (`[...slug]`)**
For handling multiple segments dynamically (`/docs/a/b/c`), use **`[...slug]`**.

Example:
```
app/docs/
 â”œâ”€â”€ [...slug]/
 â”‚   â”œâ”€â”€ page.js    â†’ Handles "/docs/a", "/docs/a/b", etc.
```

`app/docs/[...slug]/page.js`
```jsx
export default function Docs({ params }) {
  return <h1>Docs for {params.slug?.join(" / ")}</h1>;
}
```
ğŸ“Œ `/docs/nextjs/routing` â†’ Shows `Docs for nextjs / routing`

---

## **1.4 Layouts (`layout.js`)**
`layout.js` allows **shared layouts** across multiple pages.

Example: `app/layout.js`
```jsx
export default function RootLayout({ children }) {
  return (
    <html lang="en">
      <body>
        <nav>Navbar</nav>
        {children}
      </body>
    </html>
  );
}
```
ğŸ“Œ Now all pages (`/`, `/about`, `/blog`) **share this layout**.

---

# **2. File-Based Routing in Next.js (Pages Router - `pages/`)**
The **Pages Router** (legacy approach) uses the `pages/` directory for routing.

## **2.1 Defining Routes**
```
pages/
 â”œâ”€â”€ index.js     â†’ Home page ("/")
 â”œâ”€â”€ about.js     â†’ About page ("/about")
 â”œâ”€â”€ blog/
 â”‚   â”œâ”€â”€ index.js â†’ Blog homepage ("/blog")
 â”‚   â”œâ”€â”€ [slug].js â†’ Dynamic route ("/blog/:slug")
```

Example for `/about`:
`pages/about.js`
```jsx
export default function AboutPage() {
  return <h1>About Us</h1>;
}
```

---

## **2.2 Dynamic Routes (`[slug].js`)**
```
pages/blog/
 â”œâ”€â”€ [slug].js â†’ "/blog/:slug"
```

`pages/blog/[slug].js`
```jsx
import { useRouter } from "next/router";

export default function BlogPost() {
  const router = useRouter();
  return <h1>Blog Post: {router.query.slug}</h1>;
}
```
ğŸ“Œ `/blog/nextjs-routing` â†’ `Blog Post: nextjs-routing`

---

## **2.3 API Routes (`pages/api/`)**
API endpoints live in `pages/api/`.

Example: `pages/api/hello.js`
```js
export default function handler(req, res) {
  res.status(200).json({ message: "Hello from API!" });
}
```
ğŸ“Œ Access at `/api/hello`

---

# **3. Key Differences: App Router vs. Pages Router**
| Feature         | App Router (`app/`) | Pages Router (`pages/`) |
|---------------|----------------|----------------|
| **React Components** | Server & Client | Client only |
| **Layouts** | `layout.js` (built-in) | Manual `_app.js` |
| **Dynamic Routes** | `app/[slug]/page.js` | `pages/[slug].js` |
| **API Routes** | Uses **Route Handlers** (`app/api/route.js`) | `pages/api/*.js` |
| **Performance** | Faster (RSC, no hydration) | Slower (hydration needed) |

ğŸ“Œ **New projects should use the App Router (`app/`) for better performance and scalability.**

---

# **4. Nested Layouts in App Router**
The **App Router** allows deeply nested layouts.

Example:
```
app/
 â”œâ”€â”€ layout.js         â†’ Global Layout
 â”œâ”€â”€ dashboard/
 â”‚   â”œâ”€â”€ layout.js     â†’ Dashboard Layout
 â”‚   â”œâ”€â”€ page.js       â†’ "/dashboard"
 â”‚   â”œâ”€â”€ settings/
 â”‚       â”œâ”€â”€ page.js   â†’ "/dashboard/settings"
```

`app/dashboard/layout.js`
```jsx
export default function DashboardLayout({ children }) {
  return (
    <div>
      <nav>Dashboard Menu</nav>
      {children}
    </div>
  );
}
```
ğŸ“Œ Now `/dashboard` and `/dashboard/settings` **share this layout**.

# **Route Groups** 

Next.js **App Router** allows **Route Groups** to organize routes **without affecting the URL structure**. This is useful for:  
âœ… **Organizing files** without changing paths  
âœ… **Creating nested layouts** for specific sections  
âœ… **Grouping routes for middleware, authentication, or localization**  

---

## **1. Creating a Route Group** ğŸ—‚ï¸  
To create a **grouped route**, wrap it inside **(parenthesis)**:  

```
app/
 â”œâ”€â”€ (dashboard)/        â†’ Route Group (Does not appear in URL)
 â”‚   â”œâ”€â”€ layout.js       â†’ Shared layout for dashboard pages
 â”‚   â”œâ”€â”€ page.js        â†’ "/"
 â”‚   â”œâ”€â”€ analytics/
 â”‚   â”‚   â”œâ”€â”€ page.js    â†’ "/analytics"
 â”‚   â”œâ”€â”€ settings/
 â”‚       â”œâ”€â”€ page.js    â†’ "/settings"
```
ğŸ“Œ Even though `dashboard/` exists in the folder structure, it **won't appear in the URL**.

---

### **2. Example: Dashboard Route Group**
Create `app/(dashboard)/layout.js`:  
```jsx
export default function DashboardLayout({ children }) {
  return (
    <div>
      <nav>Dashboard Navigation</nav>
      {children}
    </div>
  );
}
```
ğŸ“Œ Now **all pages in `(dashboard)/` share this layout**.  

---

### **3. Example: Individual Pages in Route Group**
#### `app/(dashboard)/page.js`
```jsx
export default function DashboardHome() {
  return <h1>Welcome to the Dashboard</h1>;
}
```
ğŸ“Œ Accessible at **`/`**, NOT `/dashboard`

#### `app/(dashboard)/analytics/page.js`
```jsx
export default function AnalyticsPage() {
  return <h1>Analytics Data</h1>;
}
```
ğŸ“Œ Accessible at **`/analytics`**, NOT `/dashboard/analytics`

#### `app/(dashboard)/settings/page.js`
```jsx
export default function SettingsPage() {
  return <h1>Settings Page</h1>;
}
```
ğŸ“Œ Accessible at **`/settings`**, NOT `/dashboard/settings`

---

## **4. Why Use Route Groups?**
âœ… **Better Organization** â€“ Keep related pages together without affecting URLs  
âœ… **Shared Layouts** â€“ Apply `layout.js` to only part of the app  
âœ… **Middleware & Authentication** â€“ Apply Next.js Middleware to a specific group  

---

## **5. Combining Route Groups with Auth**
You can **protect a route group** using middleware (`middleware.js` in the root):  
```js
import { NextResponse } from "next/server";

export function middleware(req) {
  const isLoggedIn = req.cookies.get("auth_token"); // Example auth check

  if (!isLoggedIn && req.nextUrl.pathname.startsWith("/dashboard")) {
    return NextResponse.redirect(new URL("/login", req.url));
  }
}
```
ğŸ“Œ **Now all `/dashboard` routes require authentication.**

---

## **6. Localized Route Groups (i18n)**
You can use **route groups for internationalization**:

```
app/
 â”œâ”€â”€ (en)/
 â”‚   â”œâ”€â”€ page.js  â†’ "/"
 â”‚   â”œâ”€â”€ about/
 â”‚       â”œâ”€â”€ page.js â†’ "/about"
 â”œâ”€â”€ (fr)/
 â”‚   â”œâ”€â”€ page.js  â†’ "/fr"
 â”‚   â”œâ”€â”€ about/
 â”‚       â”œâ”€â”€ page.js â†’ "/fr/about"
```
ğŸ“Œ This creates localized URLs (`/` and `/fr/`), keeping code **organized**.

---

# **ğŸ¯ Final Thoughts**

âœ” **Use `(group)/` to organize pages without affecting URLs**  
âœ” **Apply shared layouts inside a group**  
âœ” **Combine with middleware for authentication or localization**  
âœ” **Works great with dynamic routes & API routes**  
âœ” **Use `app/` (App Router) for modern Next.js projects.**  
âœ” **File structure = route structure (easy to manage).**  
âœ” **Leverage layouts for shared UI.**  
âœ” **Use `[slug]` and `[...slug]` for dynamic & catch-all routes.**  
